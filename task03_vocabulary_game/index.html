<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜è€ƒèƒŒå•è¯</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #2563eb;
            margin-bottom: 10px;
        }
        
        .progress-bar {
            background: #e5e7eb;
            border-radius: 10px;
            height: 8px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            background: #2563eb;
            height: 100%;
            border-radius: 10px;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin: 20px 0;
            overflow: hidden;
        }
        
        .word-card {
            padding: 40px 20px;
            text-align: center;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .word {
            font-size: 36px;
            font-weight: bold;
            color: #2563eb;
            margin-bottom: 20px;
        }
        
        .meaning {
            font-size: 18px;
            color: #6b7280;
            display: none;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 100px;
        }
        
        .btn-primary {
            background: #2563eb;
            color: white;
        }
        
        .btn-primary:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }
        
        .btn-secondary:hover {
            background: #e5e7eb;
        }
        
        .nav-tabs {
            display: flex;
            background: white;
            border-radius: 15px;
            padding: 5px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: transparent;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            background: #2563eb;
            color: white;
        }
        
        .stats {
            text-align: center;
            color: #6b7280;
            font-size: 14px;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 24px;
            }
            
            .nav-tabs {
                padding: 3px;
                margin-bottom: 15px;
                flex-direction: column;
                gap: 5px;
            }
            
            .tab {
                padding: 10px;
                font-size: 14px;
            }
            
            .word {
                font-size: 24px;
            }
            
            .word-card {
                padding: 30px 15px;
                min-height: 180px;
            }
            
            .btn {
                padding: 12px 20px;
                font-size: 14px;
                min-width: 80px;
            }
            
            .button-group {
                flex-direction: column;
                gap: 10px;
            }
            
            .stats {
                grid-template-columns: repeat(3, 1fr);
                gap: 10px;
            }
            
            .stat-item {
                padding: 12px;
            }
            
            .stat-number {
                font-size: 1.5em;
            }
        }
        
        @media (max-width: 400px) {
            .header h1 {
                font-size: 20px;
            }
            
            .word {
                font-size: 20px;
            }
            
            .word-card {
                padding: 20px 10px;
            }
            
            .btn {
                padding: 10px 15px;
                font-size: 13px;
            }
            
            .stats {
                grid-template-columns: 1fr;
                gap: 8px;
            }
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>é«˜è€ƒèƒŒå•è¯</h1>
            <p>ç®€å•é«˜æ•ˆï¼Œä¸“æ³¨å­¦ä¹ </p>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            
            <div class="stats" id="stats">
                ä»Šæ—¥å­¦ä¹ : 0/10 | æ€»è®¡: 0 è¯
            </div>
        </div>
        
        <div class="nav-tabs">
            <button class="tab active" onclick="switchTab('learn')">æ¯æ—¥å­¦ä¹ </button>
            <button class="tab" onclick="switchTab('test')">å¿«é€Ÿæµ‹è¯•</button>
            <button class="tab" onclick="switchTab('review')" id="reviewTab">é”™è¯å¤ä¹  <span id="reviewCount">(0)</span></button>
        </div>
        
        <!-- å­¦ä¹ æ¨¡å¼ -->
        <div id="learnMode">
            <div class="card">
                <div class="word-card" id="wordCard">
                    <div class="word" id="currentWord">ç‚¹å‡»å¼€å§‹å­¦ä¹ </div>
                    <div style="font-size: 14px; color: #888; margin: 5px 0;" id="currentPhonetic"></div>
                    <div class="meaning" id="currentMeaning">ç‚¹å‡»å•è¯æŸ¥çœ‹ä¸­æ–‡é‡Šä¹‰</div>
                    <div style="font-size: 14px; color: #666; margin-top: 10px; font-style: italic;" id="currentExample"></div>
                    
                    <div class="button-group">
                        <button class="btn btn-secondary" onclick="playPronunciation()">ğŸ”Š å‘éŸ³ (P)</button>
                        <button class="btn btn-secondary" onclick="showMeaning()">æ˜¾ç¤ºé‡Šä¹‰ (S)</button>
                        <button class="btn btn-primary" onclick="nextWord()">ä¸‹ä¸€è¯ (N)</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æµ‹è¯•æ¨¡å¼ -->
        <div id="testMode" class="hidden">
            <div class="card">
                <div class="word-card">
                    <div class="word" id="testWord">å‡†å¤‡å¼€å§‹æµ‹è¯•</div>
                    
                    <div class="button-group" style="flex-direction: column; margin-top: 30px;">
                        <button class="btn btn-secondary" onclick="selectAnswer(0)" id="option0">1. é€‰é¡¹A</button>
                        <button class="btn btn-secondary" onclick="selectAnswer(1)" id="option1">2. é€‰é¡¹B</button>
                        <button class="btn btn-secondary" onclick="selectAnswer(2)" id="option2">3. é€‰é¡¹C</button>
                        <button class="btn btn-secondary" onclick="selectAnswer(3)" id="option3">4. é€‰é¡¹D</button>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <button class="btn btn-primary" onclick="startTest()" id="startTestBtn">å¼€å§‹æµ‹è¯•</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- é”™è¯å¤ä¹ æ¨¡å¼ -->
        <div id="reviewMode" class="hidden">
            <div class="card">
                <div class="word-card">
                    <div id="reviewStatus">ç‚¹å‡»å¼€å§‹å¤ä¹ é”™è¯</div>
                    <div class="word" id="reviewWord" style="display: none;">-</div>
                    <div style="font-size: 14px; color: #888; margin: 5px 0;" id="reviewPhonetic"></div>
                    <div class="meaning" id="reviewMeaning" style="display: none;">-</div>
                    <div style="font-size: 14px; color: #666; margin-top: 10px; font-style: italic;" id="reviewExample" style="display: none;"></div>
                    
                    <div class="button-group">
                        <button class="btn btn-secondary" onclick="playReviewPronunciation()" style="display: none;" id="reviewPlayBtn">ğŸ”Š å‘éŸ³ (P)</button>
                        <button class="btn btn-secondary" onclick="showReviewMeaning()" style="display: none;" id="reviewShowBtn">æ˜¾ç¤ºé‡Šä¹‰ (S)</button>
                        <button class="btn btn-primary" onclick="nextReviewWord()" style="display: none;" id="reviewNextBtn">ä¸‹ä¸€è¯ (N)</button>
                        <button class="btn btn-primary" onclick="startReview()" id="reviewStartBtn">å¼€å§‹å¤ä¹ </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- å¿«æ·é”®è¯´æ˜ -->
        <div style="text-align: center; color: #888; font-size: 12px; margin-top: 20px; padding: 10px;">
            <details>
                <summary style="cursor: pointer;">âŒ¨ï¸ é”®ç›˜å¿«æ·é”®</summary>
                <div style="margin-top: 10px; line-height: 1.6;">
                    <strong>å­¦ä¹ /å¤ä¹ æ¨¡å¼:</strong> P-å‘éŸ³ | S-æ˜¾ç¤ºé‡Šä¹‰ | N/ç©ºæ ¼-ä¸‹ä¸€è¯<br>
                    <strong>æµ‹è¯•æ¨¡å¼:</strong> 1/2/3/4-é€‰æ‹©é€‰é¡¹
                </div>
            </details>
        </div>
    </div>

    <script>
        // é«˜è€ƒæ ¸å¿ƒè¯æ±‡æ•°æ® (åˆ†æ‰¹åŠ è½½ä»¥é¿å…æ–‡ä»¶è¿‡å¤§)
        const vocabulary = [
            { word: 'abandon', meaning: 'æ”¾å¼ƒï¼ŒæŠ›å¼ƒ', phonetic: '/É™ËˆbÃ¦ndÉ™n/', example: 'Don\'t abandon hope.' },
            { word: 'ability', meaning: 'èƒ½åŠ›ï¼Œæ‰èƒ½', phonetic: '/É™ËˆbÉªlÉ™ti/', example: 'He has great ability in math.' },
            { word: 'abroad', meaning: 'åœ¨å›½å¤–ï¼Œåˆ°æµ·å¤–', phonetic: '/É™ËˆbrÉ”Ëd/', example: 'She went abroad to study.' },
            { word: 'absent', meaning: 'ç¼ºå¸­çš„ï¼Œå¿ƒä¸åœ¨ç„‰çš„', phonetic: '/ËˆÃ¦bsÉ™nt/', example: 'He was absent from school.' },
            { word: 'absolute', meaning: 'ç»å¯¹çš„ï¼Œå®Œå…¨çš„', phonetic: '/ËˆÃ¦bsÉ™luËt/', example: 'That\'s absolute nonsense!' },
            { word: 'absorb', meaning: 'å¸æ”¶ï¼Œå¸å¼•', phonetic: '/É™bËˆzÉ”Ërb/', example: 'Plants absorb water.' },
            { word: 'abstract', meaning: 'æŠ½è±¡çš„ï¼Œæ‘˜è¦', phonetic: '/ËˆÃ¦bstrÃ¦kt/', example: 'Love is an abstract concept.' },
            { word: 'abundant', meaning: 'ä¸°å¯Œçš„ï¼Œå¤§é‡çš„', phonetic: '/É™ËˆbÊŒndÉ™nt/', example: 'Fish are abundant in the lake.' },
            { word: 'abuse', meaning: 'æ»¥ç”¨ï¼Œè™å¾…', phonetic: '/É™ËˆbjuËs/', example: 'Drug abuse is dangerous.' },
            { word: 'academic', meaning: 'å­¦æœ¯çš„ï¼Œç†è®ºçš„', phonetic: '/ËŒÃ¦kÉ™ËˆdemÉªk/', example: 'She has good academic records.' },
            { word: 'accept', meaning: 'æ¥å—ï¼Œæ‰¿è®¤', phonetic: '/É™kËˆsept/', example: 'I accept your apology.' },
            { word: 'access', meaning: 'æ¥è¿‘ï¼Œé€šé“', phonetic: '/ËˆÃ¦kses/', example: 'Students have access to the library.' },
            { word: 'accident', meaning: 'æ„å¤–ï¼Œäº‹æ•…', phonetic: '/ËˆÃ¦ksÉªdÉ™nt/', example: 'There was a car accident.' },
            { word: 'accommodate', meaning: 'å®¹çº³ï¼Œé€‚åº”', phonetic: '/É™ËˆkÉ’mÉ™deÉªt/', example: 'This hotel can accommodate 200 guests.' },
            { word: 'accompany', meaning: 'é™ªä¼´ï¼Œä¼´éš', phonetic: '/É™ËˆkÊŒmpÉ™ni/', example: 'I\'ll accompany you to the station.' },
            { word: 'accomplish', meaning: 'å®Œæˆï¼Œå®ç°', phonetic: '/É™ËˆkÊŒmplÉªÊƒ/', example: 'We accomplished our goal.' },
            { word: 'account', meaning: 'è´¦æˆ·ï¼Œè§£é‡Š', phonetic: '/É™ËˆkaÊŠnt/', example: 'Open a bank account.' },
            { word: 'accurate', meaning: 'å‡†ç¡®çš„ï¼Œç²¾ç¡®çš„', phonetic: '/ËˆÃ¦kjÉ™rÉ™t/', example: 'The report is accurate.' },
            { word: 'achieve', meaning: 'è¾¾åˆ°ï¼Œå®Œæˆ', phonetic: '/É™ËˆtÊƒiËv/', example: 'He achieved his dream.' },
            { word: 'acquire', meaning: 'è·å¾—ï¼Œå­¦ä¼š', phonetic: '/É™ËˆkwaÉªÉ™/', example: 'She acquired a new skill.' },
            { word: 'across', meaning: 'ç©¿è¿‡ï¼Œåœ¨å¯¹é¢', phonetic: '/É™ËˆkrÉ’s/', example: 'Walk across the street.' },
            { word: 'active', meaning: 'ç§¯æçš„ï¼Œæ´»è·ƒçš„', phonetic: '/ËˆÃ¦ktÉªv/', example: 'He is an active student.' },
            { word: 'actual', meaning: 'å®é™…çš„ï¼ŒçœŸå®çš„', phonetic: '/ËˆÃ¦ktÊƒuÉ™l/', example: 'What\'s the actual cost?' },
            { word: 'adapt', meaning: 'é€‚åº”ï¼Œæ”¹ç¼–', phonetic: '/É™ËˆdÃ¦pt/', example: 'Animals adapt to their environment.' },
            { word: 'addition', meaning: 'åŠ æ³•ï¼Œå¢åŠ ', phonetic: '/É™ËˆdÉªÊƒÉ™n/', example: 'In addition to math, I study English.' },
            { word: 'adequate', meaning: 'å……è¶³çš„ï¼Œé€‚å½“çš„', phonetic: '/ËˆÃ¦dÉªkwÉ™t/', example: 'We need adequate supplies.' },
            { word: 'adjust', meaning: 'è°ƒæ•´ï¼Œé€‚åº”', phonetic: '/É™ËˆdÊ’ÊŒst/', example: 'Please adjust the volume.' },
            { word: 'administration', meaning: 'ç®¡ç†ï¼Œè¡Œæ”¿', phonetic: '/É™dËŒmÉªnÉªËˆstreÉªÊƒÉ™n/', example: 'The school administration is efficient.' },
            { word: 'admit', meaning: 'æ‰¿è®¤ï¼Œå…è®¸è¿›å…¥', phonetic: '/É™dËˆmÉªt/', example: 'I admit my mistake.' },
            { word: 'adopt', meaning: 'é‡‡ç”¨ï¼Œæ”¶å…»', phonetic: '/É™ËˆdÉ’pt/', example: 'They decided to adopt a child.' }
        ];
        
        let currentMode = 'learn';
        let currentIndex = 0;
        let dailyProgress = 0;
        let totalLearned = 0;
        let testQuestions = [];
        let currentTestIndex = 0;
        let correctAnswer = 0;
        let wrongWords = []; // é”™è¯æœ¬
        let testScore = { correct: 0, total: 0 };
        let reviewIndex = 0;
        
        // åˆå§‹åŒ–
        function init() {
            loadProgress();
            updateStats();
            updateReviewCount();
            startLearning();
        }
        
        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(mode) {
            currentMode = mode;
            
            // æ›´æ–°æ ‡ç­¾æ ·å¼
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            // éšè—æ‰€æœ‰æ¨¡å¼
            document.getElementById('learnMode').classList.add('hidden');
            document.getElementById('testMode').classList.add('hidden');
            document.getElementById('reviewMode').classList.add('hidden');
            
            // æ˜¾ç¤ºå¯¹åº”æ¨¡å¼
            if (mode === 'learn') {
                document.getElementById('learnMode').classList.remove('hidden');
                startLearning();
            } else if (mode === 'test') {
                document.getElementById('testMode').classList.remove('hidden');
                prepareTest();
            } else if (mode === 'review') {
                document.getElementById('reviewMode').classList.remove('hidden');
                prepareReview();
            }
        }
        
        // å¼€å§‹å­¦ä¹ 
        function startLearning() {
            if (dailyProgress >= 10) {
                document.getElementById('currentWord').textContent = 'ä»Šæ—¥å­¦ä¹ å®Œæˆï¼';
                document.getElementById('currentPhonetic').textContent = '';
                document.getElementById('currentMeaning').textContent = 'æ˜å¤©ç»§ç»­åŠªåŠ›å§ ğŸ’ª';
                document.getElementById('currentExample').textContent = '';
                document.getElementById('currentMeaning').style.display = 'block';
                return;
            }
            
            const word = vocabulary[currentIndex];
            document.getElementById('currentWord').textContent = word.word;
            document.getElementById('currentPhonetic').textContent = word.phonetic;
            document.getElementById('currentMeaning').textContent = word.meaning;
            document.getElementById('currentExample').textContent = word.example;
            document.getElementById('currentMeaning').style.display = 'none';
            document.getElementById('currentExample').style.display = 'none';
            
            // è‡ªåŠ¨æ’­æ”¾å‘éŸ³
            setTimeout(() => {
                playPronunciation();
            }, 500);
        }
        
        // æ˜¾ç¤ºé‡Šä¹‰
        function showMeaning() {
            document.getElementById('currentMeaning').style.display = 'block';
            document.getElementById('currentExample').style.display = 'block';
        }
        
        // æ’­æ”¾å‘éŸ³
        function playPronunciation() {
            const word = vocabulary[currentIndex];
            if (word && word.word) {
                // ä½¿ç”¨Web Speech APIè¿›è¡Œå‘éŸ³
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance(word.word);
                    utterance.lang = 'en-US';
                    utterance.rate = 0.8;
                    speechSynthesis.speak(utterance);
                } else {
                    alert('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³æ’­æ”¾åŠŸèƒ½');
                }
            }
        }
        
        // ä¸‹ä¸€ä¸ªå•è¯
        function nextWord() {
            dailyProgress++;
            totalLearned++;
            currentIndex = (currentIndex + 1) % vocabulary.length;
            
            saveProgress();
            updateStats();
            startLearning();
        }
        
        // å‡†å¤‡æµ‹è¯•
        function prepareTest() {
            document.getElementById('testWord').textContent = 'å‡†å¤‡å¼€å§‹æµ‹è¯•';
            document.getElementById('startTestBtn').style.display = 'inline-block';
            
            // éšè—é€‰é¡¹
            for (let i = 0; i < 4; i++) {
                document.getElementById(`option${i}`).style.display = 'none';
            }
        }
        
        // å¼€å§‹æµ‹è¯•
        function startTest() {
            if (vocabulary.length < 4) return;
            
            // éšè—å¼€å§‹æµ‹è¯•æŒ‰é’®
            document.getElementById('startTestBtn').style.display = 'none';
            
            // éšæœºé€‰æ‹©ä¸€ä¸ªå•è¯
            const randomIndex = Math.floor(Math.random() * vocabulary.length);
            const correctWord = vocabulary[randomIndex];
            
            // ç”Ÿæˆå¹²æ‰°é¡¹
            const options = [correctWord.meaning];
            while (options.length < 4) {
                const randomOption = vocabulary[Math.floor(Math.random() * vocabulary.length)].meaning;
                if (!options.includes(randomOption)) {
                    options.push(randomOption);
                }
            }
            
            // æ‰“ä¹±é€‰é¡¹
            const shuffled = options.sort(() => Math.random() - 0.5);
            correctAnswer = shuffled.indexOf(correctWord.meaning);
            
            // æ˜¾ç¤ºé¢˜ç›®
            document.getElementById('testWord').textContent = correctWord.word;
            
            // æ˜¾ç¤ºé€‰é¡¹
            for (let i = 0; i < 4; i++) {
                const btn = document.getElementById(`option${i}`);
                btn.textContent = `${i + 1}. ${shuffled[i]}`;
                btn.style.display = 'block';
                btn.style.background = '#f3f4f6';
                btn.style.color = '#374151';
            }
        }
        
        // é€‰æ‹©ç­”æ¡ˆ
        function selectAnswer(index) {
            const buttons = document.querySelectorAll('[id^="option"]');
            
            // æ›´æ–°æµ‹è¯•ç»Ÿè®¡
            testScore.total++;
            
            // é‡ç½®æ‰€æœ‰æŒ‰é’®æ ·å¼
            buttons.forEach(btn => {
                btn.style.background = '#f3f4f6';
                btn.style.color = '#374151';
            });
            
            // æ˜¾ç¤ºæ­£ç¡®ç­”æ¡ˆ
            buttons[correctAnswer].style.background = '#10b981';
            buttons[correctAnswer].style.color = 'white';
            
            // å¦‚æœé€‰é”™äº†ï¼Œæ˜¾ç¤ºé”™è¯¯å¹¶åŠ å…¥é”™è¯æœ¬
            if (index !== correctAnswer) {
                buttons[index].style.background = '#ef4444';
                buttons[index].style.color = 'white';
                
                // æ·»åŠ åˆ°é”™è¯æœ¬
                const testWord = document.getElementById('testWord').textContent;
                if (testWord && !wrongWords.includes(testWord)) {
                    wrongWords.push(testWord);
                    updateReviewCount();
                    saveProgress();
                }
            } else {
                testScore.correct++;
            }
            
            // æ˜¾ç¤ºç­”é¢˜ç»“æœ
            const resultText = index === correctAnswer ? 'âœ“ æ­£ç¡®ï¼' : 'âœ— ç­”é”™äº†';
            // åœ¨æ­£ç¡®ç­”æ¡ˆæŒ‰é’®ä¸Šæ·»åŠ ç»“æœæç¤º
            const correctBtn = buttons[correctAnswer];
            const originalText = correctBtn.textContent.split(' âœ“')[0].split(' âœ—')[0];
            correctBtn.textContent = originalText + ' ' + resultText;
            
            // 2ç§’åå¼€å§‹ä¸‹ä¸€é¢˜
            setTimeout(startTest, 2000);
        }
        
        // æ›´æ–°ç»Ÿè®¡
        function updateStats() {
            document.getElementById('stats').textContent = 
                `ä»Šæ—¥å­¦ä¹ : ${dailyProgress}/10 | æ€»è®¡: ${totalLearned} è¯`;
            
            const progress = (dailyProgress / 10) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
        }
        
        // ä¿å­˜è¿›åº¦
        function saveProgress() {
            const progress = {
                dailyProgress,
                totalLearned,
                currentIndex,
                wrongWords,
                testScore,
                date: new Date().toDateString()
            };
            localStorage.setItem('vocabProgress', JSON.stringify(progress));
        }
        
        // åŠ è½½è¿›åº¦
        function loadProgress() {
            const saved = localStorage.getItem('vocabProgress');
            if (saved) {
                const progress = JSON.parse(saved);
                
                // æ£€æŸ¥æ˜¯å¦æ˜¯æ–°çš„ä¸€å¤©
                if (progress.date !== new Date().toDateString()) {
                    dailyProgress = 0;
                } else {
                    dailyProgress = progress.dailyProgress || 0;
                }
                
                totalLearned = progress.totalLearned || 0;
                currentIndex = progress.currentIndex || 0;
                wrongWords = progress.wrongWords || [];
                testScore = progress.testScore || { correct: 0, total: 0 };
            }
        }
        
        // å‡†å¤‡é”™è¯å¤ä¹ 
        function prepareReview() {
            updateReviewCount();
            
            // é‡ç½®æŒ‰é’®çŠ¶æ€
            document.getElementById('reviewPlayBtn').style.display = 'none';
            document.getElementById('reviewShowBtn').style.display = 'none';
            document.getElementById('reviewNextBtn').style.display = 'none';
            document.getElementById('reviewStartBtn').style.display = 'inline-block';
            document.getElementById('reviewWord').style.display = 'none';
            
            if (wrongWords.length === 0) {
                document.getElementById('reviewStatus').textContent = 'æš‚æ— é”™è¯éœ€è¦å¤ä¹  ğŸ’ª';
                return;
            }
            document.getElementById('reviewStatus').textContent = `å…±æœ‰ ${wrongWords.length} ä¸ªé”™è¯éœ€è¦å¤ä¹ `;
        }
        
        // å¼€å§‹é”™è¯å¤ä¹ 
        function startReview() {
            if (wrongWords.length === 0) {
                alert('æš‚æ— é”™è¯éœ€è¦å¤ä¹ ï¼');
                return;
            }
            
            reviewIndex = 0;
            showReviewWord();
            
            // æ˜¾ç¤ºå¤ä¹ æŒ‰é’®ï¼Œéšè—å¼€å§‹æŒ‰é’®
            document.getElementById('reviewPlayBtn').style.display = 'inline-block';
            document.getElementById('reviewShowBtn').style.display = 'inline-block';
            document.getElementById('reviewNextBtn').style.display = 'inline-block';
            document.getElementById('reviewStartBtn').style.display = 'none';
        }
        
        // æ˜¾ç¤ºå¤ä¹ å•è¯
        function showReviewWord() {
            if (reviewIndex >= wrongWords.length) {
                document.getElementById('reviewStatus').textContent = 'å¤ä¹ å®Œæˆï¼âœ¨';
                document.getElementById('reviewWord').style.display = 'none';
                // å¤ä¹ å®Œæˆï¼Œé‡ç½®æŒ‰é’®
                document.getElementById('reviewPlayBtn').style.display = 'none';
                document.getElementById('reviewShowBtn').style.display = 'none';
                document.getElementById('reviewNextBtn').style.display = 'none';
                document.getElementById('reviewStartBtn').style.display = 'inline-block';
                return;
            }
            
            const wrongWordText = wrongWords[reviewIndex];
            const wordData = vocabulary.find(w => w.word === wrongWordText);
            
            if (wordData) {
                document.getElementById('reviewStatus').textContent = `å¤ä¹ è¿›åº¦: ${reviewIndex + 1}/${wrongWords.length}`;
                document.getElementById('reviewWord').textContent = wordData.word;
                document.getElementById('reviewWord').style.display = 'block';
                document.getElementById('reviewPhonetic').textContent = wordData.phonetic;
                document.getElementById('reviewMeaning').textContent = wordData.meaning;
                document.getElementById('reviewExample').textContent = wordData.example;
                document.getElementById('reviewMeaning').style.display = 'none';
                document.getElementById('reviewExample').style.display = 'none';
                
                // è‡ªåŠ¨æ’­æ”¾å‘éŸ³
                setTimeout(() => {
                    playReviewPronunciation();
                }, 500);
            }
        }
        
        // æ˜¾ç¤ºå¤ä¹ é‡Šä¹‰
        function showReviewMeaning() {
            document.getElementById('reviewMeaning').style.display = 'block';
            document.getElementById('reviewExample').style.display = 'block';
        }
        
        // æ’­æ”¾å¤ä¹ å‘éŸ³
        function playReviewPronunciation() {
            const word = wrongWords[reviewIndex];
            if (word && 'speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(word);
                utterance.lang = 'en-US';
                utterance.rate = 0.8;
                speechSynthesis.speak(utterance);
            }
        }
        
        // ä¸‹ä¸€ä¸ªå¤ä¹ å•è¯
        function nextReviewWord() {
            reviewIndex++;
            showReviewWord();
        }
        
        // æ›´æ–°é”™è¯æ•°é‡æ˜¾ç¤º
        function updateReviewCount() {
            document.getElementById('reviewCount').textContent = `(${wrongWords.length})`;
        }
        
        // é”®ç›˜å¿«æ·é”®æ”¯æŒ
        document.addEventListener('keydown', function(event) {
            // é˜²æ­¢åœ¨è¾“å…¥æ¡†ä¸­è§¦å‘
            if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') return;
            
            const key = event.key.toLowerCase();
            
            // å­¦ä¹ æ¨¡å¼å¿«æ·é”®
            if (currentMode === 'learn') {
                switch(key) {
                    case 'p':
                        event.preventDefault();
                        playPronunciation();
                        break;
                    case 's':
                        event.preventDefault();
                        showMeaning();
                        break;
                    case 'n':
                    case ' ': // ç©ºæ ¼é”®ä¹Ÿå¯ä»¥åˆ‡æ¢åˆ°ä¸‹ä¸€è¯
                        event.preventDefault();
                        nextWord();
                        break;
                }
            }
            
            // å¤ä¹ æ¨¡å¼å¿«æ·é”®
            if (currentMode === 'review') {
                switch(key) {
                    case 'p':
                        event.preventDefault();
                        playReviewPronunciation();
                        break;
                    case 's':
                        event.preventDefault();
                        showReviewMeaning();
                        break;
                    case 'n':
                    case ' ':
                        event.preventDefault();
                        nextReviewWord();
                        break;
                }
            }
            
            // æµ‹è¯•æ¨¡å¼å¿«æ·é”® (1-4 é€‰æ‹©é€‰é¡¹)
            if (currentMode === 'test') {
                switch(key) {
                    case '1':
                        event.preventDefault();
                        selectAnswer(0);
                        break;
                    case '2':
                        event.preventDefault();
                        selectAnswer(1);
                        break;
                    case '3':
                        event.preventDefault();
                        selectAnswer(2);
                        break;
                    case '4':
                        event.preventDefault();
                        selectAnswer(3);
                        break;
                }
            }
        });

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = init;
    </script>
</body>
</html>